<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head th:replace="fragments/header :: head('Home Page')"></head>

<body class="d-flex flex-column min-vh-100"> <!-- Flexbox applied -->
<header th:replace="fragments/header :: navbar"></header>

<main class="container mt-4 flex-grow-1"> <!-- Ensures main content expands -->
    <h1>Welcome to the Event Management System</h1>
    <p>Find, create, and manage your events easily.</p>

    <div class="row">
        <div class="col-md-12">
            <h2>Upcoming Events</h2>
            <table class="table table-bordered">
                <thead class="table-dark">
                <tr>
                    <th>Event Name</th>
                    <th>Organizer</th>
                    <th>Start Date</th>
                    <th>End Date</th>
                    <th>Location</th>
                    <th>Available Places</th>
                    <th>Actions</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="event : ${events}">
                    <td>
                        <a th:href="@{/events/{id}(id=${event.id})}" th:text="${event.name}"></a>
                    </td>
                    <td th:text="${event.organizer.username}"></td>
                    <td th:text="${#dates.format(event.startDate, 'dd/MM/yyyy HH:mm')}"></td>
                    <td th:text="${#dates.format(event.endDate, 'dd/MM/yyyy HH:mm')}"></td>
                    <td th:text="${event.place.name}"></td>
                    <td th:text="${event.maxParticipants - event.participants.size()}"></td>
                    <td>
                        <a th:if="${(event.maxParticipants - event.participants.size()) > 0}"
                           class="btn btn-success"
                           th:href="@{/events/join/{id}(id=${event.id})}">
                            Join
                        </a>
                        <span th:if="${(event.maxParticipants - event.participants.size()) <= 0}" class="text-danger">
                                Full
                            </span>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>

        <div class="col-md-6">
            <h2>Create an Event</h2>
            <a class="btn btn-primary" th:href="@{/events/create}">Create Event</a>
        </div>
    </div>
</main>

<footer th:replace="fragments/footer :: footer"></footer>
</body>
</html>